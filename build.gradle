group 'hashcode.bali'
version '1.0-SNAPSHOT'

apply plugin: 'java'

sourceCompatibility = 1.8

repositories {
    mavenCentral()
}

dependencies {
    testCompile group: 'junit', name: 'junit', version: '4.12'
}

// TODO zip des sources

// TODO appel envoi source


new File("${buildDir}/resources/main/input/").listFiles().each {
    input ->
    // FIXME gerer de multiples appels au Main, a l'heure actuelle on ne fait qu'un appel
    if (input.isFile()) {
        task "bali${input.name}"(type: JavaExec) {
            print "Nom du fichier ${input.name}\n"
            def output = input.name.split("\\.")[0] + ".out"
            print "Nom de la sortie ${output}\n"
            standardInput = new FileInputStream(input.absoluteFile)
            standardOutput = new FileOutputStream("${buildDir}/$output")
            main = "hashcode.Main"
        }
    }
}


task baliAll {
    print "All"
    dependsOn 'baliexample.in'
    dependsOn 'balismall.in'
}